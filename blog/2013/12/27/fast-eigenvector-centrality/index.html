
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Fast Eigenvector Centrality - Zarrar's Journaling</title>
  <meta name="author" content="Zarrar Shehzad">

  
  <meta name="description" content="I’m working on adding the fast eigenvector centrality code1 to CPAC. A big thing about the fast code is that it only works with unthresholded data. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://czarrar.github.io/blog/2013/12/27/fast-eigenvector-centrality/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Zarrar's Journaling" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">mob</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Zarrar's Journaling</a></h1>
  
    <h2>To the edge and beyond</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:czarrar.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Fast Eigenvector Centrality</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-27T19:15:00-05:00" pubdate data-updated="true">Dec 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I’m working on adding the fast eigenvector centrality code<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> to CPAC. A big thing about the fast code is that it only works with unthresholded data. So one thing that we will do is </p>

<h2 id="unit-testing">Unit Testing</h2>

<p>I have a set of unit tests in <code>CPAC/network_centrality/tests/core.py</code>. I don’t like the filename core and should look to changing that. I wonder if the filenames can be somewhat generic with one file that has all the CPAC/nipype relevant code, another that has more utility functions, and a last one that does the core functionality. Something to consider.</p>

<p>So I have tests that use random data and run the following commands to generate the data:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># Normalize Random Time-Series Data</span>
</span><span class="line"><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">ntpts</span><span class="p">,</span><span class="n">nvoxs</span><span class="p">))</span>
</span><span class="line"><span class="n">m</span> <span class="o">=</span> <span class="n">norm_cols</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span class="line"><span class="c"># Correlation Data with Range 0-1</span>
</span><span class="line"><span class="n">mm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="c"># note that need to generate connectivity matrix here</span>
</span><span class="line"><span class="n">mm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">mm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Note the range of the correlation values is changed to be 0-1 since</p>

<ol>
  <li>Negative values don’t make much sense for the eigenvectors</li>
  <li>The power method used in the fast approach is based on this range</li>
</ol>

<p>Then, we can create the two different outputs based on the original and faster approach.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">ref</span>  <span class="o">=</span> <span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class="line"><span class="n">comp</span> <span class="o">=</span> <span class="n">fast_eigenvector_centrality</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>We finally compare the outputs and make sure they are almost equal, which it should. This degree of similarity however seems to be a little lower when using real data.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ref</span><span class="o">-</span><span class="n">comp</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span class="line"><span class="n">ok_</span><span class="p">(</span><span class="n">diff</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">spacing</span><span class="p">(</span><span class="mf">1e2</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="confusion">Confusion</h2>

<p>One point of confusion is why do you multiply the eigenvectors by your correlation matrix and then divide by your dominant eigenvalue? This is done in CPAC’s standard eigenvector centrality code and likely stems from work in Lohmann et al<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>. TODO: finish this section explaining my possible misunderstanding…</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>todo add citation.<a href="#fnref:1" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>todo add citation.<a href="#fnref:2" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Zarrar Shehzad</span></span>

      








  


<time datetime="2013-12-27T19:15:00-05:00" pubdate data-updated="true">Dec 27<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cmi/'>cmi</a>, <a class='category' href='/blog/categories/cpac/'>cpac</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://czarrar.github.io/blog/2013/12/27/fast-eigenvector-centrality/" data-via="" data-counturl="http://czarrar.github.io/blog/2013/12/27/fast-eigenvector-centrality/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2013/12/27/test-smoothing/" title="Previous Post: Test Smoothing">&laquo; Test Smoothing</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  

<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/abide' style='font-size: 128.0%'>abide(7)</a> <a href='/blog/categories/cmi' style='font-size: 160.0%'>cmi(15)</a> <a href='/blog/categories/cpac' style='font-size: 148.0%'>cpac(12)</a> <a href='/blog/categories/cwas' style='font-size: 140.0%'>cwas(10)</a> <a href='/blog/categories/emotional-bs' style='font-size: 108.0%'>emotional-bs(2)</a> <a href='/blog/categories/jekyll' style='font-size: 104.0%'>jekyll(1)</a> <a href='/blog/categories/mdmr' style='font-size: 104.0%'>mdmr(1)</a> <a href='/blog/categories/nilearn' style='font-size: 112.0%'>nilearn(3)</a> <a href='/blog/categories/quickpack' style='font-size: 124.0%'>quickpack(6)</a> <a href='/blog/categories/r' style='font-size: 104.0%'>r(1)</a> <a href='/blog/categories/simulations' style='font-size: 104.0%'>simulations(1)</a> <a href='/blog/categories/work' style='font-size: 104.0%'>work(1)</a> <a href='/blog/categories/writedown' style='font-size: 104.0%'>writedown(1)</a> </span>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/27/fast-eigenvector-centrality/">Fast Eigenvector Centrality</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/test-smoothing/">Test Smoothing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/20/derivative-class/">Derivative Class</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/18/dparsf-quick-pack/">DPARSF Quick Pack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/17/cpac-derivative-inputs/">CPAC Derivative Inputs</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/czarrar">@czarrar</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'czarrar',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll...</ul>
  <p><a href="http://pinboard.in/u:czarrar">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "czarrar"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>

<!--
    Calendar aside/plugin for octopress blogging framework.
    Copyright (C) 2012  Neeraj Kumar ( neerajpkumar@gmail.com, neerajkumar@outlook.com)

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<style>
	.highlighted-calendar-day
	{
		color : #CCC;
		font-weight : bold;
	}
	
	.calendar-header-day{
		font-weight : bold;
		color : #AAA;
		font-size : 14px;
	}
	
	.highlighted-calendar-day a
	{
		
	}
	
	.prev-link
	{
		float:left;
	}
	
	.next-link
	{
		float: right;
	}
	.calendar-day
	{
		color : #888;
		font-weight : 12px;
	}
	
	.calendar-table
	{
		width : 100%;
		
	}
	
	.calendar-table td
	{
		border-right : dotted 1px lightgrey;
		text-align : center;
	}
	
	.calendar-table td:last-child
	{
		border-right : none;
	}
	
	.calendar-table th
	{
		background-color : lightgrey;
		text-align : center;
	}
	.prevCalendarLink img
	{	
		
		width : 20px;
		height : 20px;
		border: 0px;
		float: left;
		
	}
	
	.nextCalendarLink img
	{
		
		width : 20px;
		height: 20px;
		border: 0px;
		float: right;
		
	}
</style>
<script type="text/javascript" src="/javascripts/calendar.js"></script>
<section id="calendarDiv">
	<h1>Calendar</h1>
	<span style="display:block" id="calendarSpan"></span>
	<div>
		<a href="#" class="previousMonth show"/><a href="#" class="nextMonth hide"/>
	</div>
</section>
<script type="text/javascript">
  
monthCalendar = function(id,year,month)
{
  var highlightArray = new Array();
  var hightlightLinks = new Array();
  
  highlightArray.push('12/27/2013');
  hightlightLinks.push('/blog/2013/12/27/fast-eigenvector-centrality/');
  
  highlightArray.push('12/27/2013');
  hightlightLinks.push('/blog/2013/12/27/test-smoothing/');
  
  highlightArray.push('12/20/2013');
  hightlightLinks.push('/blog/2013/12/20/derivative-class/');
  
  highlightArray.push('12/18/2013');
  hightlightLinks.push('/blog/2013/12/18/dparsf-quick-pack/');
  
  highlightArray.push('12/17/2013');
  hightlightLinks.push('/blog/2013/12/17/cpac-derivative-inputs/');
  		
  var cal = new Calendar(month,year,highlightArray,hightlightLinks);
  cal.generateHTML(id);
  var element = document.getElementById(id);
  element.innerHTML = cal.getHTML();
}
	
loadCalendar = function(){
  var now = new Date();
  var month = now.getMonth();
  var year = now.getFullYear();
  monthCalendar('calendarDiv',year,month);
}
	
	if(Array.prototype.indexOf == undefined)
	{
		 Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
			"use strict";
			if (this == null) {
				throw new TypeError();
			}
			var t = Object(this);
			var len = t.length >>> 0;
			if (len === 0) {
				return -1;
			}
			var n = 0;
			if (arguments.length > 0) {
				n = Number(arguments[1]);
				if (n != n) { // shortcut for verifying if it's NaN
					n = 0;
				} else if (n != 0 && n != Infinity && n != -Infinity) {
					n = (n > 0 || -1) * Math.floor(Math.abs(n));
				}
			}
			if (n >= len) {
				return -1;
			}
			var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
			for (; k < len; k++) {
				if (k in t && t[k] === searchElement) {
					return k;
				}
			}
			return -1;
		}
	}
$(document).ready(function(){
  loadCalendar();
});
</script>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Zarrar Shehzad -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
