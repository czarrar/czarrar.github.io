
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Thursday - Week 47 - Zarrar's Journaling</title>
  <meta name="author" content="Zarrar Shehzad">

  
  <meta name="description" content="Today mostly revolved around memory profiling to work in python. Summary is as follows. Looked into memory profiling Had issues with memprof but got &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://czarrar.github.io/blog/2013/11/21/thursday-week-47/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Zarrar's Journaling" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">mob</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Zarrar's Journaling</a></h1>
  
    <h2>To the edge and beyond</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:czarrar.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Thursday - Week 47</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-11-21T11:34:00-05:00" pubdate data-updated="true">Nov 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Today mostly revolved around memory profiling to work in python. Summary is as follows.</p>

<ul>
  <li>Looked into memory profiling
    <ul>
      <li>Had issues with memprof but got heapy to work (links below).</li>
      <li>Got memprof to work not through numpy</li>
      <li>Also applied memory_profiler (a little bit more accurate and useful than memprof).</li>
      <li>Finally also applied memtop (a wrapper around ps)</li>
    </ul>
  </li>
  <li>Attended lab meeting</li>
  <li>Discussion of ABIDE with Chao-Gan and then Cameron</li>
</ul>

<h2 id="memory-profiling">Memory Profiling</h2>

<p>Want to examine the memory usage of centrality in CPAC.</p>

<h3 id="choosing-a-package">Choosing a Package</h3>

<p>There are several python packages available with an extensive list available on stackoverflow: http://stackoverflow.com/questions/110259/which-python-memory-profiler-is-recommended.</p>

<p>Some that do not seem appropriate for our purposes:</p>

<ul>
  <li><a href="https://launchpad.net/meliae">Meliae</a>: No documentation.</li>
  <li><a href="http://pythonhosted.org/Pympler/muppy.html">Muppy</a>: Not that useful.</li>
</ul>

<p>One particular issue that I’ll be dealing with are how well it will work with nipype.</p>

<h3 id="path-issue">Path Issue</h3>

<p>The first problem I faced was the memory profiling not being on the path. This wasn’t so obvious because in the interactive shell of python and python, the memory profiling packages that were recently installed were available. However, when running python (the same python) from the command-line, then it couldn’t find it. The fix was simply to add my python site-packages to the path. Should know in the future that the paths for the interactive vs command-line python can be different.</p>

<h3 id="heapy">Heapy</h3>

<p>So when I actually ran memprof, it ended up failing. I went through all the other packages and was able to get <a href="http://smira.ru/wp-content/uploads/2011/08/heapy.html">heapy</a> to work. The approach taken with heapy is to call an individual function to measure the memory usage, whereas the other approaches all use a decorator of some kind. It worked, but the RAM values all seemed a bit low and not very convenient to read, so I tried another approach.</p>

<h3 id="memprof">Memprof</h3>

<p>Now I’ll be looking at <a href="http://jmdana.github.io/memprof">Memprof</a>, recommended by Cameron and also on the <a href="http://stackoverflow.com/questions/110259/which-python-memory-profiler-is-recommended">stackoverflow page</a>. Since it won’t work with nipype, I manually ran the <code>calc_centrality</code> function. This approach gave me some memory read outs. However, because it doesn’t actually record the memory usage of a particular command (when all the correlations are calculated), the maximum memory is about 160 + 11 or 171MB in total. This is a lot lower than I calculated and much lower than what I saw in top, which maxed out at around 4GB.</p>

<p>[add pics]</p>

<h3 id="memory-profiler">Memory Profiler</h3>

<p>The other approach <a href="https://pypi.python.org/pypi/memory_profiler">memory_profiler</a> was a bit more useful. It showed about 1.4gb being used at the peak (around the correlation calculation).</p>

<h3 id="memtop">Memtop</h3>

<p>I also used a command-line tool <a href="http://www.webhostingtalk.com/showthread.php?t=1256200">memtop</a> that wraps around the command-line tool <code>ps</code>. This showed 4.2gb being used at the peak.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Zarrar Shehzad</span></span>

      








  


<time datetime="2013-11-21T11:34:00-05:00" pubdate data-updated="true">Nov 21<span>st</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cpac/'>cpac</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://czarrar.github.io/blog/2013/11/21/thursday-week-47/" data-via="" data-counturl="http://czarrar.github.io/blog/2013/11/21/thursday-week-47/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2013/11/20/wednesday-week-47/" title="Previous Post: Wednesday - Week 47">&laquo; Wednesday - Week 47</a>
      
      
        <a class="basic-alignment right articlenav" href="/blog/2013/11/22/friday-week-47/" title="Next Post: Friday - Week 47">Friday - Week 47 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  <section>
  <h1>Contents</h1>
  <ol class="nested" style="margin-left: 1.3em;">
<li class="nested" style="list-style:inherit;">
	<a href="#memory-profiling">Memory Profiling</a>
<ol class="nested" style="margin-left: 1.3em;">		<li class="nested" style="list-style:inherit;"><a href="#choosing-a-package">Choosing a Package</a></li>
 		<li class="nested" style="list-style:inherit;"><a href="#path-issue">Path Issue</a></li>
 		<li class="nested" style="list-style:inherit;"><a href="#heapy">Heapy</a></li>
 		<li class="nested" style="list-style:inherit;"><a href="#memprof">Memprof</a></li>
 		<li class="nested" style="list-style:inherit;"><a href="#memory-profiler">Memory Profiler</a></li>
 		<li class="nested" style="list-style:inherit;"><a href="#memtop">Memtop</a></li>
</ul>
</li></ol>
  </section>

<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/abide' style='font-size: 160.0%'>abide(7)</a> <a href='/blog/categories/cmi' style='font-size: 134.28571428571428%'>cmi(4)</a> <a href='/blog/categories/cpac' style='font-size: 160.0%'>cpac(7)</a> <a href='/blog/categories/cwas' style='font-size: 160.0%'>cwas(7)</a> <a href='/blog/categories/emotional-bs' style='font-size: 117.14285714285714%'>emotional-bs(2)</a> <a href='/blog/categories/jekyll' style='font-size: 108.57142857142857%'>jekyll(1)</a> <a href='/blog/categories/mdmr' style='font-size: 108.57142857142857%'>mdmr(1)</a> <a href='/blog/categories/nilearn' style='font-size: 125.71428571428572%'>nilearn(3)</a> <a href='/blog/categories/quickpack' style='font-size: 151.42857142857144%'>quickpack(6)</a> <a href='/blog/categories/writedown' style='font-size: 108.57142857142857%'>writedown(1)</a> </span>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/11/27/wednesday-week-48/">Wednesday - Week 48</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/26/tuesday-week-48/">Tuesday - Week 48</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/25/updating-centrality/">Updating Centrality</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/25/monday-week-48/">Monday - Week 48</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/24/timing-comparison/">Timing Comparison</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/czarrar">@czarrar</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'czarrar',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll...</ul>
  <p><a href="http://pinboard.in/u:czarrar">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "czarrar"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>

<!--
    Calendar aside/plugin for octopress blogging framework.
    Copyright (C) 2012  Neeraj Kumar ( neerajpkumar@gmail.com, neerajkumar@outlook.com)

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<style>
	.highlighted-calendar-day
	{
		color : #CCC;
		font-weight : bold;
	}
	
	.calendar-header-day{
		font-weight : bold;
		color : #AAA;
		font-size : 14px;
	}
	
	.highlighted-calendar-day a
	{
		
	}
	
	.prev-link
	{
		float:left;
	}
	
	.next-link
	{
		float: right;
	}
	.calendar-day
	{
		color : #888;
		font-weight : 12px;
	}
	
	.calendar-table
	{
		width : 100%;
		
	}
	
	.calendar-table td
	{
		border-right : dotted 1px lightgrey;
		text-align : center;
	}
	
	.calendar-table td:last-child
	{
		border-right : none;
	}
	
	.calendar-table th
	{
		background-color : lightgrey;
		text-align : center;
	}
	.prevCalendarLink img
	{	
		
		width : 20px;
		height : 20px;
		border: 0px;
		float: left;
		
	}
	
	.nextCalendarLink img
	{
		
		width : 20px;
		height: 20px;
		border: 0px;
		float: right;
		
	}
</style>
<script type="text/javascript" src="/javascripts/calendar.js"></script>
<section id="calendarDiv">
	<h1>Calendar</h1>
	<span style="display:block" id="calendarSpan"></span>
	<div>
		<a href="#" class="previousMonth show"/><a href="#" class="nextMonth hide"/>
	</div>
</section>
<script type="text/javascript">
  
monthCalendar = function(id,year,month)
{
  var highlightArray = new Array();
  var hightlightLinks = new Array();
  
  highlightArray.push('11/27/2013');
  hightlightLinks.push('/blog/2013/11/27/wednesday-week-48/');
  
  highlightArray.push('11/26/2013');
  hightlightLinks.push('/blog/2013/11/26/tuesday-week-48/');
  
  highlightArray.push('11/25/2013');
  hightlightLinks.push('/blog/2013/11/25/updating-centrality/');
  
  highlightArray.push('11/25/2013');
  hightlightLinks.push('/blog/2013/11/25/monday-week-48/');
  
  highlightArray.push('11/24/2013');
  hightlightLinks.push('/blog/2013/11/24/timing-comparison/');
  		
  var cal = new Calendar(month,year,highlightArray,hightlightLinks);
  cal.generateHTML(id);
  var element = document.getElementById(id);
  element.innerHTML = cal.getHTML();
}
	
loadCalendar = function(){
  var now = new Date();
  var month = now.getMonth();
  var year = now.getFullYear();
  monthCalendar('calendarDiv',year,month);
}
	
	if(Array.prototype.indexOf == undefined)
	{
		 Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
			"use strict";
			if (this == null) {
				throw new TypeError();
			}
			var t = Object(this);
			var len = t.length >>> 0;
			if (len === 0) {
				return -1;
			}
			var n = 0;
			if (arguments.length > 0) {
				n = Number(arguments[1]);
				if (n != n) { // shortcut for verifying if it's NaN
					n = 0;
				} else if (n != 0 && n != Infinity && n != -Infinity) {
					n = (n > 0 || -1) * Math.floor(Math.abs(n));
				}
			}
			if (n >= len) {
				return -1;
			}
			var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
			for (; k < len; k++) {
				if (k in t && t[k] === searchElement) {
					return k;
				}
			}
			return -1;
		}
	}
$(document).ready(function(){
  loadCalendar();
});
</script>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Zarrar Shehzad -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
