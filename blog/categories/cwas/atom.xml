<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: cwas | Zarrar's Journaling]]></title>
  <link href="http://czarrar.github.io/blog/categories/cwas/atom.xml" rel="self"/>
  <link href="http://czarrar.github.io/"/>
  <updated>2013-12-02T19:34:09-05:00</updated>
  <id>http://czarrar.github.io/</id>
  <author>
    <name><![CDATA[Zarrar Shehzad]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[CWAS Simulations]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/01/cwas-simulations/"/>
    <updated>2013-12-01T21:01:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/01/cwas-simulations</id>
    <content type="html"><![CDATA[<p>The code for the simulation analysis is located in <code>/home/data/Projects/CWAS/share/simulations</code>. I have added multiprocessing functionality to speed up the ability to go through the different parameters and iterations.</p>

<p>I have started running one iteration of things including both variables of interest. Holy crap, it finished in like 30mins, super quick.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 49 - Sunday]]></title>
    <link href="http://czarrar.github.io/blog/2013/11/30/week-49-sunday/"/>
    <updated>2013-11-30T21:47:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/11/30/week-49-sunday</id>
    <content type="html"><![CDATA[<p>This is a bit of a cheat since I started this on Saturday (week 48).</p>

<h2 id="todo">TODO</h2>

<p>I’m trying to use the workflow for this.</p>

<h2 id="comparing-distances">Comparing Distances</h2>

<p>I was able to finish making the figure as well as the text for the paper. I added all this information to the response letter.</p>

<h2 id="simulations">Simulations</h2>

<p>I ran this and need to double check. However, I do think that something went wrong here. I need to double check the code and spot check the effect sizes given. </p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Timing Comparison]]></title>
    <link href="http://czarrar.github.io/blog/2013/11/24/timing-comparison/"/>
    <updated>2013-11-24T15:21:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/11/24/timing-comparison</id>
    <content type="html"><![CDATA[<h2 id="overview">Overview</h2>

<p>I will be comparing the timing for the following functions:</p>

<ul>
  <li>Degree Centrality</li>
  <li>GLM</li>
  <li>MDMR</li>
  <li>SVM (linear)</li>
  <li>K-Means Clustering</li>
</ul>

<p>This order also reflects the speed result (first is faster).</p>

<h2 id="parameters">Parameters</h2>

<p>I examined the speed for examining connectivity-phenotype relationships for the following parameters:</p>

<ul>
  <li>number of nodes or connectivity maps: <strong>10</strong></li>
  <li>number of elements in each connectivity map: <strong>800</strong></li>
  <li>number of participants: <strong>100</strong></li>
  <li>number of iterations: <strong>100</strong></li>
</ul>

<p>In the case of SVM and K-Means, I did the analysis like I did with MDMR. I examined the fit between one connectivity map per participant and participant group membership. Thus, the analysis was repeated 10 times, one for each connectivity map.</p>

<p>This whole process was repeated 100 times.</p>

<h2 id="system">System</h2>

<p>The timing analysis was performed on a MacBook Pro OSX v10.8 using a 2.53GHz Intel Core 2 Duo with 4GB of RAM.</p>

<h2 id="results">Results</h2>

<p>A graph shows the average timing for each approach across 100 iterations below.</p>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = google.visualization.arrayToDataTable([
      ['Method', 'Time'],
      ['Degree',  6],
      ['GLM',  		30],
      ['MDMR',  	52],
      ['SVM',  		229], 
		 ['K-Means', 788]
    ]);

    var options = {
      title: 'Average time (ms) to compute connectivity-phenotype association',
      hAxis: {title: 'Method'}, 
		 legend: {position: 'none'}
    };

    var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script>

<div id="chart_div" style="width: 500px; height: 300px;"></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Similarity of IQ CWAS Across Scans]]></title>
    <link href="http://czarrar.github.io/blog/2013/11/24/similarity-of-iq-cwas-across-scans/"/>
    <updated>2013-11-24T11:51:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/11/24/similarity-of-iq-cwas-across-scans</id>
    <content type="html"><![CDATA[<p>Get the overlap (dice) and similarity (spearman) of the IQ CWAS between scans, and estimate the significance. Below are the current results for a simple comparison.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">measures</th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">dice</td>
      <td>0.2731</td>
    </tr>
    <tr>
      <td style="text-align: right">pearson</td>
      <td>0.2571</td>
    </tr>
    <tr>
      <td style="text-align: right">spearman</td>
      <td>0.2511</td>
    </tr>
    <tr>
      <td style="text-align: right">kendalls</td>
      <td>0.1695</td>
    </tr>
  </tbody>
</table>

<p>Let’s focus on just the dice and spearman for now. For a proper permutation test, I want to make sure that the permuted subject indices are the same for scan 1 and 2. This would allow one to test the hypothesis of how similar the CWAS results for IQ are between scans when given a random list of participants.</p>

<h2 id="re-running-mdmr-for-scan-2">Re-Running MDMR for Scan 2</h2>

<p>This understanding mean I need to rerun the MDMR for scan 2 using the permutation indices from scan 1. I have created a new script to run these modified MDMR analyses for scan 2.</p>

<p><code>
cd /home2/data/Projects/CWAS/share/nki/05_cwas
./30_mdmr_using_perms.bash
</code></p>

<h2 id="permutations-for-dice-and-spearman">Permutations for dice and spearman</h2>

<p>Now we need to take the extra time to gather p-values for everything so we can threshold and compare. I’ll use some of the false positive code <code>share/results/20_cwas_iq/40_false_positives.R</code> in getting the p-values of the permutations. The result of this inspiration can be found in <code>/home2/data/Projects/CWAS/share/figures/fig_03</code> where I created the <code>E2_compare_scans.R</code> file. This script does the following (among other things):</p>

<ol>
  <li>Read in the permuted Fstats</li>
  <li>Loop through each permutation so you can</li>
  <li>Calculate significance for both scans</li>
  <li>Compare the two scans with dice (p &lt; 0.05) and spearman</li>
  <li>Return this result and loop to #3 for the next permutation</li>
</ol>

<p>Note that I’m not clustering correcting for the dice comparison and I’m using p-values here instead of F-stats.</p>

<h2 id="results">Results</h2>

<p>Highly significant with dice = 0.2731411 (p &lt; 0.001 or p = 0.0003) and spearman rho = 0.2510524 (p &lt; 0.005 or p = 0.004).</p>

<h2 id="update-connectir">Update Connectir</h2>

<p>To do this analysis, I updated the MDMR script to accept an external permutation file. This is with the new option <code>--permfiles</code>. It accepts a list of descriptor files (comma separated) that should reflect the number of factors2perm.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Saturday - Week 47]]></title>
    <link href="http://czarrar.github.io/blog/2013/11/23/saturday-week-47/"/>
    <updated>2013-11-23T13:54:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/11/23/saturday-week-47</id>
    <content type="html"><![CDATA[<p>This page covers both Saturday and Sunday (which is technically week 48).</p>

<h2 id="todo">TODO</h2>

<ul>
  <li><strong>Permutation test for dice and spearman with IQ CWAS</strong>
    <ul>
      <li><em>DONE</em></li>
    </ul>
  </li>
  <li><strong>Compare computational time for MDMR to other approaches</strong>
    <ul>
      <li><em>DONE</em></li>
    </ul>
  </li>
  <li><strong>Bootstrap analyses</strong>
    <ul>
      <li><em>DONE</em></li>
    </ul>
  </li>
  <li><strong>Compare different distances</strong>
    <ul>
      <li><em>DONE WITH TABLES</em></li>
      <li><em>GENERATE SURFACE RESULTS</em></li>
      <li><em>WRITE TEXT FOR PAPER</em></li>
      <li><em>UPDATE RESPONSE</em></li>
    </ul>
  </li>
  <li><strong>Simulations</strong>
    <ul>
      <li><em>WRITE CODE</em></li>
      <li><em>GENERATE PLOTS</em></li>
      <li><em>ADD TO RESPONSE LETTER</em></li>
    </ul>
  </li>
  <li><strong>Results</strong>
    <ul>
      <li><em>RE-COMPUTE WHERE NEEDED</em></li>
      <li><em>ADD TO PAPER</em></li>
    </ul>
  </li>
  <li><strong>Update paper with stuff from response letter</strong>
    <ul>
      <li><em>I guess waiting for feedback on response letter</em></li>
    </ul>
  </li>
</ul>

<h2 id="similarity-of-iq-cwas-across-scans">Similarity of IQ CWAS across scans</h2>

<p>See details at <a href="/2013/11/24/similarity-of-iq-cwas-across-scans/">my other post</a>.</p>

<p>Highly significant with dice = 0.2731411 (p &lt; 0.001 or p = 0.0003) and spearman rho = 0.2510524 (p &lt; 0.005 or p = 0.004).</p>

<h2 id="computational-time">Computational Time</h2>

<p>Below is the average time (ms) across 100 iterations. MDMR is a little slower than GLM but comparable.</p>

<p><code>
   method      time
1  Degree   5.76817
2     GLM  30.12167
3    MDMR  51.73251
4     SVM 228.89548
5 K-Means 788.41195
</code></p>

<p>Further details can be found on the <a href="/2013/11/24/timing-comparison/">following post</a>.</p>

<h2 id="comparing-distances">Comparing Distances</h2>

<p>Further details can be found on the <a href="/2013/11/09/comparing-distances">following post</a>.</p>

<h2 id="simulations">Simulations</h2>

<p>Getting a late start on the simulations. </p>

]]></content>
  </entry>
  
</feed>
