<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: cmi | Zarrar's Journaling]]></title>
  <link href="http://czarrar.github.io/blog/categories/cmi/atom.xml" rel="self"/>
  <link href="http://czarrar.github.io/"/>
  <updated>2013-12-09T20:11:39-05:00</updated>
  <id>http://czarrar.github.io/</id>
  <author>
    <name><![CDATA[Zarrar Shehzad]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Week 50 - Monday]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/09/week-50-monday/"/>
    <updated>2013-12-09T20:03:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/09/week-50-monday</id>
    <content type="html"><![CDATA[<h2 id="plansummary">Plan/Summary</h2>

<ul>
  <li>[x] Email Maarten with the results</li>
  <li>[x] Add running Xinian’s filtering script to my Basecamp TODO</li>
  <li>[x] Integrate updated CWAS code into master CPAC branch</li>
  <li>[] Tagging (e 1 hr)</li>
  <li>[] QC (e 1 hr)</li>
  <li>[] Finish fast eigenvector centrality code (not workflow)</li>
</ul>

<p>While above were items that I had planned in the morning, items below reflect additions to this plan during the day.</p>

<ul>
  <li>[x] cleaned up the code to use regression test data to run a python CPAC and R version of CWAS.</li>
  <li>[x] wrote code to smooth 4D functional data in standard space</li>
  <li>[x] write code to use smoothed data for CWAS</li>
  <li>[x] write some additional code to use internal CPAC filepaths for CWAS</li>
  <li>[x] write code to parse group analysis model inputs for CWAS</li>
</ul>

<p>The coding for CWAS in CPAC went surprisingly well. Hopefully, this streak might continue tomorrow when testing.</p>

<h2 id="integrating-cwas-code-with-cpac">Integrating CWAS Code with CPAC</h2>

<p>My issue in using the main CPAC repository was that although I was a member, I needed to be made an owner. After figuring this out, I created a ‘cwas’ branch and added the relevant changes to the cwas folder.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 49 - Friday]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/06/week-49-friday/"/>
    <updated>2013-12-06T10:35:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/06/week-49-friday</id>
    <content type="html"><![CDATA[<h2 id="plan">Plan</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[] QC (1 hour)</li>
    </ul>
  </li>
  <li>CPAC
    <ul>
      <li>[] Finish adapting fast eigenvector code (30 mins)</li>
      <li>[] Write SVD version of eigenvector (1 hour)</li>
      <li>[] Test new eigenvector code (2 hours)</li>
      <li>[] @Steve CWAS Regression Test (1 hour)</li>
    </ul>
  </li>
  <li>Tagging
    <ul>
      <li>[] Meeting to discuss criteria (1 hour)</li>
    </ul>
  </li>
</ul>

<p>Look into SVD (20 mins). But it’s slower.</p>

<p><code>python
import numpy as np
from numpy.linalg import svd
from scipy.sparse.linalg import eigsh
mat = np.random.random((100,1000))
%timeit u,s,v = svd(mat.T, False)
%timeit evalue, evector = eigsh(mat.T.dot(mat), k=1, which='LM', maxiter=1000) 
</code></p>

<p>In this case the current approach took 45.2ms and the SVD approach took 135ms.</p>

<h2 id="fast-eigenvector-centrality">Fast Eigenvector Centrality</h2>

<p>The plan for testing would be to first make sure that the code results are close to the original approach and possibly also compare to an SVD approach.</p>

<h2 id="brain-size-ala-maarten">Brain Size ala Maarten</h2>

<p>We ended up dropping the ball in getting Maarten some of these scripts.</p>

<p>I need to create an input file with <code>T1file,age,sex</code>. If I am using the NKI Rockland pilot dataset, then I believe I should be able to find the relevant path. For the most recent data, there have been additions so let me confirm that I have access to everything. Ok so first, pilot dataset.</p>

<p>``` r
rawdir    &lt;- ‘/home2/data/Originals/Rockland/raw’
phenofile &lt;- ‘/home2/data/Originals/Rockland/NKI.1-39_phenotypic.csv’</p>

<p>pheno     &lt;- read.csv(phenofile)
df        &lt;- pheno[,c(1,3,12)]
df$paths  &lt;- file.path(rawdir, df$Subject, “touse”, “anat”, “mprage.nii.gz”)
df$exists &lt;- file.exists(df$paths)*1</p>

<p>df.txt &lt;- df[df$exists==1,c(4,3,2)]
write.table(df.txt, file=”rockland_pilot.txt”, row.names=F, col.names=F, quote=F)
```</p>

<p>I want to now look at the Enhanced dataset.</p>

<h2 id="thoughts">Thoughts</h2>

<h3 id="plan-better">Plan Better</h3>

<p>Last few days I feel that I haven’t gotten through as much as I could have. Possibly due to not sleeping as much and partly due to more socializing like with the speaker’s visit and a new office mate. Let’s try differently today.</p>

<h3 id="link-to-pages-by-week-and-month">Link to pages by week and month</h3>

<p>Another nice thing would be to have a summary page at the end of the week with links to all the other pages that week (might want to check if those exist?) and similarly at the end of the month could have a page with the lists for that month. I wonder if this could be within the pages section?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 49 - Wednesday]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/04/week-49-wednesday/"/>
    <updated>2013-12-04T10:02:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/04/week-49-wednesday</id>
    <content type="html"><![CDATA[<h2 id="summarytodo">Summary/TODO</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[x] QC (1 hour)</li>
    </ul>
  </li>
  <li>CPAC (related to ABIDE)
    <ul>
      <li>[] Functional Density Mapping</li>
      <li>[] Fast Eigenvector Centrality
        <ul>
          <li>[x] Respond to Wink</li>
          <li>[x] Tried installing the C++ version (1 hr)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>[] Tagging</li>
  <li>Dan Dickstein CWAS
    <ul>
      <li>[x] Get details from Dan</li>
      <li>[x] Phil Meeting about CWAS Paper. Discussed way to get confidence intervals for simulation power analysis. (1 hr)</li>
    </ul>
  </li>
  <li>CWAS with Steve. Worked out a plan to have a workable version of CWAS into the next release (30 min)</li>
  <li>Went to talk with Matt Hutchinson. Asked a super intelligent question. (1-2 hrs)</li>
</ul>

<h2 id="abide-qc">ABIDE QC</h2>

<p>Start at 10am till 11am.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 49 - Tuesday]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/03/week-49-tuesday/"/>
    <updated>2013-12-03T11:30:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/03/week-49-tuesday</id>
    <content type="html"><![CDATA[<p>testing draft</p>

<h2 id="summarytodo">Summary/TODO</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[x] Create quick pack for degree centrality</li>
      <li>[x] Email Xinian about GSR data and having filtered/non-filtered</li>
      <li>[x] Finish creating quick pack for LFCD</li>
    </ul>
  </li>
  <li>CPAC
    <ul>
      <li>[] Run an initial test of the functional node</li>
    </ul>
  </li>
  <li>Tag</li>
</ul>

<p>I also took the speaker (Matt) out to lunch with Zhen, and then showed him some of my slides about CWAS.</p>

<h2 id="quick-pack-for-centrality">Quick Pack for Centrality</h2>

<h3 id="cpac-preprocessed-data">CPAC Preprocessed Data</h3>

<p>The scripts for this analysis are located in <code>/data/Projects/ABIDE_Initiative/CPAC/abide/config/30_centrality</code>. I was able to first generate a subject list YAML file with <code>10_gen_quick_pack.py</code>. Below is a sample of what a file for one subject looks like:</p>

<p><code>
  functional_brain_mask: {filt_global: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
    filt_noglobal: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
    nofilt_global: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
    nofilt_noglobal: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz}
</code></p>

<p>We can see that we have each filtering and global option as the input. This is a little bit of cheating since the different input keys are interpreted as different scans.</p>

<p>We can then use these different inputs in one CPAC run with <code>20_run_gen_quick_pack.py</code>. This script is currently running and the output/working directories can be found in <code>/data/Projects/ABIDE_Initiative/Derivatives/CPAC/Cent</code>.</p>

<h2 id="eigenvector-centrality">Eigenvector Centrality</h2>

<p>I emailed out to the author of the fast implementation paper to ask for his C++ code. However, if the author does not respond, the paper is fairly descriptive and I imagine it would be possible to write our own code based on the methods description.</p>

<h2 id="qc">QC</h2>

<p>I created the new excel file and looked through one subject. Should confirm the following: should have columns for anat, func, and reg with comments for each of those, and a final status column and final comments column. Do I need anything for the segmentations?</p>

<h2 id="functional-density-mapping">Functional Density Mapping</h2>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 49 - Monday]]></title>
    <link href="http://czarrar.github.io/blog/2013/12/02/week-49-monday/"/>
    <updated>2013-12-02T13:25:00-05:00</updated>
    <id>http://czarrar.github.io/blog/2013/12/02/week-49-monday</id>
    <content type="html"><![CDATA[<h2 id="summary">Summary</h2>

<ul>
  <li>Checked and finalized fixing a subject.</li>
  <li>Resolved questions with QC</li>
  <li>Discussed issue with VMHC</li>
  <li>Setup quick pack for Xinian’s dataset</li>
  <li>Read through the eigenvector centrality paper</li>
  <li>Went through a few articles for tagging with updated instructions</li>
</ul>

<h2 id="todos">TODOs</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>Check on fixed subject</li>
      <li>Email about QC</li>
      <li>Look into VMHC issue on github</li>
      <li>Create quick packs for everyone</li>
      <li>Email to ask about eigenvector centrality</li>
    </ul>
  </li>
  <li>Check fixed subject</li>
  <li>Find out about tagging</li>
</ul>

<h2 id="abide---fixed-subject">ABIDE - Fixed Subject</h2>

<p>I reran one participant with missing derivatives. It appears that everything is good.</p>

<h2 id="abide---quick-packs">ABIDE - Quick Packs</h2>

<p>We are looking to have the following derivatives:</p>

<ul>
  <li>Timeseries for different regions of interest</li>
  <li>Dual Regression maps</li>
  <li>ALFF/fALFF</li>
  <li>REHO</li>
  <li>Degree/Eigen Centrality</li>
  <li>VMHC</li>
</ul>

<h3 id="cameron">Cameron</h3>

<p>For our data, we already have most of the above derivatives and need the following:</p>

<ul>
  <li>Degree/Eigen Centrality</li>
  <li>VMHC</li>
</ul>

<p>Degree I should be able to run now but need to wait on Eigen and VMHC.</p>

<h3 id="xinian">Xinian</h3>

<p>I started to create the quick pack for this dataset. The one issue is that it’s unclear whether the global signal correction was applied to either the filtered or non-filtered data. It should be applied to both so will need to contact some people in order to figure out how to resolve this issue. Hopefully no heads will roll.</p>

<p>The scripts and what not for this dataset quick pack are located in <code>/data/Projects/ABIDE_Initiative/CPAC/abide/config/32_xinian</code>. I still need to write some code to generate the standard brain mask and of course test it all as well.</p>

<h3 id="pierre">Pierre</h3>

<p>Pierre’s is already in standard space so I believe I should simply be able to turn off <code>runRegisterFuncToMNI</code> and also my custom option <code>applyRegisterFuncToMNI</code>. The regular outputs should be good enough.</p>

<h3 id="chao-gan">Chao-Gan</h3>

<p>Check with Chao-Gan.</p>

<h2 id="abide---qc">ABIDE - QC</h2>

<p>I should do a similar approach as Yang and reference an email from Pierre with some guidelines.</p>

<h2 id="eigenvector-centrality">Eigenvector Centrality</h2>

<p>I did a bit of reading last time about a faster approach to eigenvector centrality. Now I went through the main paper again. It appears that their speed-up is primarily by not having to compute the cross product between a matrix of time series (voxels x time points). They split this step up into two parts that reduces the complexity from N^2 to 2NT where N = voxels and T = time points. They make a claim that for voxelwise data, they see a speedup of 1000x.</p>

<h2 id="tagging">Tagging</h2>

<p>Spoke to Cameron. We discussed some potential changes and I emailed these out to him and Matt.</p>

<p>In terms of tagging, here were some important points to note:</p>

<ul>
  <li>use mike’s opinions as the standard</li>
  <li>basic neuroscience is a superset of brain/behavior</li>
  <li>only include resting-state fMRI studies!</li>
</ul>

<h2 id="cwas">CWAS</h2>

<p>I got emails from Xavier and Phil with comments. I should look to integrate them.</p>

]]></content>
  </entry>
  
</feed>
