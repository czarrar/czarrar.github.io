
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Zarrar's Journaling</title>
  <meta name="author" content="Zarrar Shehzad">

  
  <meta name="description" content="I want to first get down what files from the DPARSF preprocessed output correspond to inputs needed by CPAC for running the derivatives. A big thing &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://czarrar.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Zarrar's Journaling" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">mob</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Zarrar's Journaling</a></h1>
  
    <h2>To the edge and beyond</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:czarrar.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/18/dparsf-quick-pack/">DPARSF Quick Pack</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-18T17:14:00-05:00" pubdate data-updated="true">Dec 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want to first get down what files from the DPARSF preprocessed output correspond to inputs needed by CPAC for running the derivatives.</p>

<p>A big thing here is that I am running DPARSF in native space. Then on the this derivative data, I would normalize it using DARTELS. And I guess then apply smoothing using DPARSF. How to I apply smoothing with Chao-Gan’s script (emailed him to find out)?</p>

<h2 id="naming-conventions">Naming Conventions</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class=""><span class="line">A=slice timing
</span><span class="line">R=renormalization
</span><span class="line">C=covariate regressed
</span><span class="line">W=spatially normalized
</span><span class="line">S=smoothed
</span><span class="line">F=filtered
</span><span class="line">Sym=for VMH
</span><span class="line">global=GSR</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="anatomical">Anatomical</h2>

<p>I don’t need any of these since they are only for registration</p>

<h2 id="functional">Functional</h2>

<ul>
  <li>functional_brain_mask</li>
  <li>functional_nuisance_residuals</li>
  <li>functional_freq_filtered</li>
  <li></li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/17/cpac-derivative-inputs/">CPAC Derivative Inputs</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-17T19:24:00-05:00" pubdate data-updated="true">Dec 17<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want to try to organize what inputs are needed for what derivates for CPAC. First, I have the list of template inputs for quick pack for the CCS pipeline:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">anat_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">&quot;anatomical_brain&quot;</span><span class="p">:</span> <span class="s">&quot;mprage_sanlm.nii.gz&quot;</span><span class="p">,</span>     <span class="c"># check</span>
</span><span class="line">    <span class="s">&quot;anatomical_reorient&quot;</span><span class="p">:</span> <span class="s">&quot;reg/highres_rpi.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;anatomical_to_mni_nonlinear_xfm&quot;</span><span class="p">:</span> <span class="s">&quot;reg/highres2standard_warp.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;mni_normalized_anatomical&quot;</span><span class="p">:</span> <span class="s">&quot;reg/fnirt_highres2standard.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">func_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">&quot;preprocessed&quot;</span><span class="p">:</span> <span class="s">&quot;rest_res.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;mean_functional&quot;</span><span class="p">:</span> <span class="s">&quot;rest_pp_mean.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;functional_brain_mask&quot;</span><span class="p">:</span> <span class="s">&quot;rest_pp_mask.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;functional_nuisance_residuals&quot;</span><span class="p">:</span> <span class="s">&quot;rest_pp_nofilt_sm0.nii.gz&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="s">&quot;functional_freq_filtered&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">rest_pp_</span><span class="si">%(pipeline)s</span><span class="s">_sm0.nii.gz&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">/rest_pp_</span><span class="si">%(pipeline)s</span><span class="s">_sm0.nii.gz&quot;</span><span class="p">],</span>
</span><span class="line">    <span class="s">&quot;functional_mni&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">rest.</span><span class="si">%(pipeline)s</span><span class="s">.sm0.mni152.nii.gz&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">/rest.</span><span class="si">%(pipeline)s</span><span class="s">.sm0.mni152.nii.gz&quot;</span><span class="p">],</span>
</span><span class="line">    <span class="s">&quot;functional_brain_mask_to_standard&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span> <span class="c"># I would need to make this myself</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">reg_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">&quot;functional_to_anat_linear_xfm&quot;</span><span class="p">:</span> <span class="s">&quot;reg/example_func2highres.mat&quot;</span>
</span><span class="line"><span class="c">#    &quot;functional_to_mni_linear_xfm&quot;: &quot;functional_to_mni_linear_xfm.mat&quot;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now I go through each of the files to see if they are really needed. If not, then I will want to make sure that it is also processed as optional in my ghetto quick pack code.</p>

<h2 id="anatomicals">Anatomicals</h2>

<h3 id="anatomicalbrain">anatomical_brain</h3>

<p><strong>Yes</strong> it is needed for <strong>all the steps</strong> but <strong>only with ANTS</strong>. It is used by the applywarp sections of code and I think particularly for transforming FSL’s registration matrix to ANTs format (again i think).</p>

<h3 id="anatomicalreorient">anatomical_reorient</h3>

<p>Only <strong>VMHC?</strong>.</p>

<h3 id="anatomicaltomninonlinearxfm">anatomical_to_mni_nonlinear_xfm</h3>

<p><strong>Yes</strong> for <strong>all the steps</strong> but <strong>only for applying the registration</strong>.</p>

<h3 id="mninormalizedanatomical">mni_normalized_anatomical</h3>

<p><strong>No</strong>. This is only used in QC and so this can be removed from the set of inputs that I generate.</p>

<h2 id="functional">Functional</h2>

<h3 id="preprocessed">preprocessed</h3>

<p><strong>No</strong>. This is used in scrubbing and QC so it too can be removed from the set of inputs that I generate.</p>

<h3 id="meanfunctional">mean_functional</h3>

<p><strong>No but in VMHC</strong> it is used. Not sure how long that will last.</p>

<h3 id="functionalbrainmask">functional_brain_mask</h3>

<p><strong>Yes</strong> it is used in <strong>many (all?) steps</strong>.</p>

<h3 id="functionalnuisanceresiduals">functional_nuisance_residuals</h3>

<p><strong>Yes</strong> for <strong>ALFF and fALFF</strong>. Note that this uses the set_leaf_properties and get_leaf_properties function to dynamically get so it won’t be so obvious. This option can also be used for the other derivatives if you don’t want them to be filtered.</p>

<h3 id="functionalfreqfiltered">functional_freq_filtered</h3>

<p><strong>Yes</strong> for <strong>everything where want filtering</strong>.</p>

<h3 id="functionalmni">functional_mni</h3>

<p><strong>Yes</strong> for <strong>Spatial Regression, ROI time series, Voxel time series, Temporal Regression for SCA, Network Centrality</strong></p>

<h3 id="functionalbrainmasktostandard">functional_brain_mask_to_standard</h3>

<p><strong>Yes</strong> but <strong>only when apply registration</strong>. Although should also need it for the above ones…</p>

<h2 id="final">Final</h2>

<p>Ok so the final list, here again. Note that I didn’t discuss the reg one.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">anat_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">&quot;anatomical_brain&quot;</span><span class="p">:</span> <span class="s">&quot;mprage_sanlm.nii.gz&quot;</span><span class="p">,</span>          <span class="c"># REGISTRATION</span>
</span><span class="line">    <span class="s">&quot;anatomical_reorient&quot;</span><span class="p">:</span> <span class="s">&quot;reg/highres_rpi.nii.gz&quot;</span><span class="p">,</span>    <span class="c"># VMHC?</span>
</span><span class="line">    <span class="s">&quot;anatomical_to_mni_nonlinear_xfm&quot;</span><span class="p">:</span> <span class="s">&quot;reg/highres2standard_warp.nii.gz&quot;</span><span class="p">,</span>  <span class="c"># REGISTRATION</span>
</span><span class="line"><span class="c">#    &quot;mni_normalized_anatomical&quot;: &quot;reg/fnirt_highres2standard.nii.gz&quot;,      # NOT NEEDED </span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">func_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line"><span class="c">#    &quot;preprocessed&quot;: &quot;rest_res.nii.gz&quot;,             # NOT NEEDED</span>
</span><span class="line"><span class="c">#    &quot;mean_functional&quot;: &quot;rest_pp_mean.nii.gz&quot;,      # VMHC?</span>
</span><span class="line">    <span class="s">&quot;functional_brain_mask&quot;</span><span class="p">:</span> <span class="s">&quot;rest_pp_mask.nii.gz&quot;</span><span class="p">,</span> <span class="c"># YES </span>
</span><span class="line">    <span class="s">&quot;functional_nuisance_residuals&quot;</span><span class="p">:</span> <span class="s">&quot;rest_pp_nofilt_sm0.nii.gz&quot;</span><span class="p">,</span>  <span class="c"># YES (although not really used)</span>
</span><span class="line">    <span class="s">&quot;functional_freq_filtered&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">rest_pp_</span><span class="si">%(pipeline)s</span><span class="s">_sm0.nii.gz&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">/rest_pp_</span><span class="si">%(pipeline)s</span><span class="s">_sm0.nii.gz&quot;</span><span class="p">],</span>    <span class="c"># YES</span>
</span><span class="line">    <span class="s">&quot;functional_mni&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">rest.</span><span class="si">%(pipeline)s</span><span class="s">.sm0.mni152.nii.gz&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%(strategy)s</span><span class="s">/rest.</span><span class="si">%(pipeline)s</span><span class="s">.sm0.mni152.nii.gz&quot;</span><span class="p">],</span>      <span class="c"># YES</span>
</span><span class="line">    <span class="s">&quot;functional_brain_mask_to_standard&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>                                                                                         <span class="c"># Yes</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">reg_suffixes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s">&quot;functional_to_anat_linear_xfm&quot;</span><span class="p">:</span> <span class="s">&quot;reg/example_func2highres.mat&quot;</span> <span class="c"># REGISTRATION </span>
</span><span class="line"><span class="c">#    &quot;functional_to_mni_linear_xfm&quot;: &quot;functional_to_mni_linear_xfm.mat&quot;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/13/week-50-friday/">Week 50 - Friday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-13T12:01:00-05:00" pubdate data-updated="true">Dec 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There’s been a bit of a lull in writing these entries. Hoping to get back on the train.</p>

<p><strong>What are the dominant issues for today?</strong></p>

<ul>
  <li>
    <p>I found that yesterday that the fast eigencentrality code doesn’t work when the inputs are normalized data (mean=0, sd=1). I am not totally sure what’s going on but I can try to use the matlab code directly to see if my python port is missing something. I might first try with random data and then with some imaging data if possible. The imaging data could be used to directly compare with the python code. I might keep these test code blocks as gists.</p>
  </li>
  <li>
    <p>I should make a table of all the processing steps that are needed for the ABIDE dataset. I want to run some of these things in the background as I can so as not to pile up.</p>
  </li>
</ul>

<h2 id="testing-fast-eigenvector-code">Testing Fast Eigenvector Code</h2>

<p>When I ran both the python and the fast code without the normalization of the time-series. I get the same results in both datasets. However, with normalization of the timeseries, I get different results. One suggestion from Steve was that there might be a difference in some normalization.</p>

<p>Details of my simplified comparison can be found on https://gist.github.com/czarrar/7950474 and at the bottom of the post.</p>

<h2 id="abide">ABIDE</h2>

<p>Let’s first make a table and workflow explaining everything. I’ll add it here first and then move it to another spot later.</p>

<p>I was able to start the processing for degree centrality with our dataset. I should be able to…</p>

<h2 id="gist">Gist</h2>

<div><script src="https://gist.github.com/7950474.js"></script>
<noscript><pre><code>import numpy as np
from CPAC.cwas.subdist import norm_cols
from fast_ecm import fast_eigenvector_centrality # this is from the other gist; can ignore this and paste in the other function

print 'Compare with non-normalized matrices'

m  = np.random.random((200,1000))
cm = m.T.dot(m)

# Let's first call a basic approach
# This actually doesn't work, not sure what I'm setting wrong
from scipy import linalg as LA
w01,v01 = LA.eigh(cm, eigvals=(0,0))
e01     = cm.dot(np.abs(v01))/w01[0]

# Let's call a second basic approach (used currently)
from scipy.sparse import linalg as sLA
w02,v02 = sLA.eigsh(cm, k=1, which='LM', maxiter=1000)
e02     = cm.dot(np.abs(v02))/w02[0]

# Finally let's call the fast eigenvector (power approach)
v03     = fast_eigenvector_centrality(m, verbose=False)

# How different are the second and third ones?
print 'mean absolute diff: ', np.abs(e02-v03).mean()
print 'correlation: ', np.corrcoef(e02.T, v03.T)[0,1]



print 'Compare with normalized matrices'

n  = norm_cols(m)
cn = n.T.dot(n)

# Let's first call a basic approach
from scipy import linalg as LA
w11,v11 = LA.eigh(cn, eigvals=(0,0))
e11     = cn.dot(np.abs(v11))/w11[0]

# Let's call a second basic approach (used currently)
from scipy.sparse import linalg as sLA
w12,v12 = sLA.eigsh(cn, k=1, which='LM', maxiter=1000)
e12     = cn.dot(np.abs(v12))/w12[0]

# Finally let's call the fast eigenvector (power approach)
v13     = fast_eigenvector_centrality(n, verbose=False)

# How different are the second and third ones?
print 'mean absolute diff: ', np.abs(e12-v13).mean()
print 'correlation: ', np.corrcoef(e12.T, v13.T)[0,1]
</code></pre></noscript></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/10/installing-connectir/">Installing Connectir</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-10T11:46:00-05:00" pubdate data-updated="true">Dec 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are several steps that appear to lend themselves to a problem with installing all the dependencies and stuff for connectir. First let me go through trying to install R with openblas, which leads to problems when using any of the parallel processing in R. </p>

<h2 id="r-with-openblas">R with OpenBlas</h2>

<p>The below links are relevant in detailing the issue/solutions between openblas and parallel processing libraries. The issue is “On Linux, OpenBLAS sets the processor affinity by default. This may cause the conflict with R parallel. You can build the library with NO_AFFINITY=1.”</p>

<ul>
  <li>http://www.stat.cmu.edu/~nmv/2013/07/09/for-faster-r-use-openblas-instead-better-than-atlas-trivial-to-switch-to-on-ubuntu/#comment-128</li>
  <li>https://stat.ethz.ch/pipermail/r-sig-hpc/2012-April/001348.html</li>
  <li>https://github.com/xianyi/OpenBLAS/wiki/faq#wiki-no_affinity</li>
</ul>

<p>Note that you can also set this on runtime with <code>export OPENBLAS_MAIN_FREE=1</code>.</p>

<p>Unfortunately on each loop of foreach I get the following error.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="r"><span class="line"> <span class="o">***</span> caught segfault <span class="o">***</span>
</span><span class="line">address <span class="mh">0x7f717d9b99d0</span><span class="p">,</span> cause <span class="s">&#39;memory not mapped&#39;</span>
</span><span class="line">
</span><span class="line">Traceback<span class="o">:</span>
</span><span class="line"> <span class="m">1</span><span class="o">:</span> mcexit<span class="p">(</span><span class="m">0L</span><span class="p">)</span>
</span><span class="line"> <span class="m">2</span><span class="o">:</span> FUN<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">[[</span><span class="m">1L</span><span class="p">]],</span> <span class="kc">...</span><span class="p">)</span>
</span><span class="line"> <span class="m">3</span><span class="o">:</span> lapply<span class="p">(</span>seq_len<span class="p">(</span>cores<span class="p">),</span> inner.do<span class="p">)</span>
</span><span class="line"> <span class="m">4</span><span class="o">:</span> mclapply<span class="p">(</span>argsList<span class="p">,</span> FUN<span class="p">,</span> mc.preschedule <span class="o">=</span> preschedule<span class="p">,</span> mc.set.seed <span class="o">=</span> set.seed<span class="p">,</span>     mc.silent <span class="o">=</span> silent<span class="p">,</span> mc.cores <span class="o">=</span> cores<span class="p">)</span>
</span><span class="line"> <span class="m">5</span><span class="o">:</span> e<span class="o">$</span>fun<span class="p">(</span>obj<span class="p">,</span> substitute<span class="p">(</span>ex<span class="p">),</span> parent.frame<span class="p">(),</span> e<span class="o">$</span>data<span class="p">)</span>
</span><span class="line"> <span class="m">6</span><span class="o">:</span> foreach<span class="p">(</span>i <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span> <span class="o">%dopar%</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I will need to come back to this error in this future for fixing.</p>

<h2 id="test-smoothing">Test Smoothing</h2>

<p>I created the following setup to test 2 subjects with the new smoothing of standard functionals.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">cd <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>CPAC_Regression_Test
</span><span class="line">mkdir smooth_tests
</span><span class="line"><span class="c1"># cwas branch of CPAC</span>
</span><span class="line">cd smooth_tests
</span><span class="line">git clone https<span class="o">://</span>github.com<span class="o">/</span>FCP<span class="o">-</span>INDI<span class="o">/</span>C<span class="o">-</span>PAC.git
</span><span class="line">cd C<span class="o">-</span>PAC
</span><span class="line">git checkout cwas
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I also copied over the following config files and edited them:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nb">cd</span> /home2/data/Projects/CPAC_Regression_Test
</span><span class="line"><span class="c"># only use 2 subjects</span>
</span><span class="line">cp 2013-12-05_v-0-3-3/run/CPAC_subject_list.yml smooth_tests/
</span><span class="line"><span class="c"># remove any derivatives from being run</span>
</span><span class="line">cp 2013-12-05_v-0-3-3/run/pipeline_config_regtest.yml smooth_tests/
</span><span class="line"><span class="c"># </span>
</span><span class="line">cp 2013-12-05_v-0-3-3/run/run-CPAC_v-0-3-3.py smooth_tests/
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Errors:
- invalid connection
- unknown func_preproc_0</p>

<p>I fixed the above but then got some error with just running the pipeline.</p>

<p>spent 3 hrs.</p>

<h2 id="maarten-brain-sizes">Maarten Brain Sizes</h2>

<p>Maarten received the results for NKI-RS and NK-RS enhanced fine but was missing one file (missing the ac-pc-fov.txt file for all subjects). In addition, he wanted to have results for the COBRA subjects. I got the path for this from Dan and should be easy to run the script on these participants.</p>

<h3 id="fixing-missing-file">Fixing missing file</h3>

<p>The file in question is <code>ac-pc-fov.txt</code> and is returned by the <code>DOfovC.sh</code> script. Below is the command that I ran for testing.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">.<span class="o">/</span>get_brain_size.py <span class="o">-</span>inputfile <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">10</span>_rockland_pilot<span class="o">/</span>anat_test.txt <span class="o">-</span>tempdir <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">10</span>_rockland_pilot<span class="o">/</span>test <span class="o">-</span>scriptdir <span class="o">$</span><span class="p">(</span>pwd<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It seems that some loop was being skipped and other files weren’t being generated, which led to the error. I did some other funnies to investigate and fix the issue such as convert the <code>DOfovC.sh</code> script to be bash.</p>

<h3 id="re-running">Re-Running</h3>

<p>I need to re-run two studies and run one for the first time. Run the following on gelert.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="r"><span class="line"><span class="c1"># Rockland Pilot</span>
</span><span class="line">.<span class="o">/</span>get_brain_size.py <span class="o">-</span>inputfile <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">10</span>_rockland_pilot<span class="o">/</span>anat_demographics.txt <span class="o">-</span>tempdir <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">10</span>_rockland_pilot<span class="o">/</span>results <span class="o">-</span>scriptdir <span class="o">$</span><span class="p">(</span>pwd<span class="p">)</span>
</span><span class="line"><span class="c1"># Rockland Enhanced</span>
</span><span class="line">.<span class="o">/</span>get_brain_size.py <span class="o">-</span>inputfile <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">20</span>_rockland_enhanced<span class="o">/</span>anat_demographics.txt <span class="o">-</span>tempdir <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">20</span>_rockland_enhanced<span class="o">/</span>results <span class="o">-</span>scriptdir <span class="o">$</span><span class="p">(</span>pwd<span class="p">)</span>
</span><span class="line"><span class="c1"># COBRA</span>
</span><span class="line">.<span class="o">/</span>get_brain_size.py <span class="o">-</span>inputfile <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">30</span>_cobra<span class="o">/</span>anat_demographics.txt <span class="o">-</span>tempdir <span class="o">/</span>home2<span class="o">/</span>data<span class="o">/</span>Projects<span class="o">/</span>brain_sizes<span class="o">/</span><span class="m">30</span>_cobra<span class="o">/</span>results <span class="o">-</span>scriptdir <span class="o">$</span><span class="p">(</span>pwd<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/09/week-50-monday/">Week 50 - Monday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-09T20:03:00-05:00" pubdate data-updated="true">Dec 9<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="plansummary">Plan/Summary</h2>

<ul>
  <li>[x] Email Maarten with the results</li>
  <li>[x] Add running Xinian’s filtering script to my Basecamp TODO</li>
  <li>[x] Integrate updated CWAS code into master CPAC branch</li>
  <li>[] Tagging (e 1 hr)</li>
  <li>[] QC (e 1 hr)</li>
  <li>[] Finish fast eigenvector centrality code (not workflow)</li>
</ul>

<p>While above were items that I had planned in the morning, items below reflect additions to this plan during the day.</p>

<ul>
  <li>[x] cleaned up the code to use regression test data to run a python CPAC and R version of CWAS.</li>
  <li>[x] wrote code to smooth 4D functional data in standard space</li>
  <li>[x] write code to use smoothed data for CWAS</li>
  <li>[x] write some additional code to use internal CPAC filepaths for CWAS</li>
  <li>[x] write code to parse group analysis model inputs for CWAS</li>
</ul>

<p>The coding for CWAS in CPAC went surprisingly well. Hopefully, this streak might continue tomorrow when testing.</p>

<h2 id="integrating-cwas-code-with-cpac">Integrating CWAS Code with CPAC</h2>

<p>My issue in using the main CPAC repository was that although I was a member, I needed to be made an owner. After figuring this out, I created a ‘cwas’ branch and added the relevant changes to the cwas folder.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/07/cwas-simulations/">CWAS Simulations</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-07T16:39:00-05:00" pubdate data-updated="true">Dec 7<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It seems that my previous set of simulations may go down the drain as they weren’t relevant to the reviewer’s concern.</p>

<p>So now, I am looking into a new set of simulations focused on examining properties of the MDMR approach using resting-state functional connectivity data.</p>

<h2 id="methods">Methods</h2>

<p>One question is how can we implement our simulations. Here are the general steps:</p>

<ol>
  <li>
    <p>Compute 1000 voxelwise connectivity maps at 4mm isotropic for all my 104 participants.</p>
  </li>
  <li>
    <p>Using GLM remove the effects of other variables to get residual connectivity maps</p>
  </li>
  <li>
    <p>Add in group effect and vary certain factors</p>
  </li>
</ol>

<p>Step three is crucial and is discussed later.</p>

<h3 id="factors">Factors</h3>

<p>What are the factors that we want to measure?</p>

<ul>
  <li>Number of ‘clusters’ that differ</li>
  <li>Extent of each ‘cluster’ that differ</li>
  <li>Effect size</li>
</ul>

<p>Another set of factors that could be examined is the variation in the effect size across the connectivity map. For now, I guess we shall assume a constant difference with some random noise.</p>

<p>Do we really need to be examining some of these steps? I’m thinking that we just focus on the effect size and simply generate a gaussian random field </p>

<h3 id="implementation">Implementation</h3>

<p>I’m assuming that I have a matrix with each participant’s connectivity map at one voxel. </p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/06/week-49-friday/">Week 49 - Friday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-06T10:35:00-05:00" pubdate data-updated="true">Dec 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="plan">Plan</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[] QC (1 hour)</li>
    </ul>
  </li>
  <li>CPAC
    <ul>
      <li>[] Finish adapting fast eigenvector code (30 mins)</li>
      <li>[] Write SVD version of eigenvector (1 hour)</li>
      <li>[] Test new eigenvector code (2 hours)</li>
      <li>[] @Steve CWAS Regression Test (1 hour)</li>
    </ul>
  </li>
  <li>Tagging
    <ul>
      <li>[] Meeting to discuss criteria (1 hour)</li>
    </ul>
  </li>
</ul>

<p>Look into SVD (20 mins). But it’s slower.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">svd</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigsh</span>
</span><span class="line"><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
</span><span class="line"><span class="o">%</span><span class="n">timeit</span> <span class="n">u</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
</span><span class="line"><span class="o">%</span><span class="n">timeit</span> <span class="n">evalue</span><span class="p">,</span> <span class="n">evector</span> <span class="o">=</span> <span class="n">eigsh</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s">&#39;LM&#39;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>In this case the current approach took 45.2ms and the SVD approach took 135ms.</p>

<h2 id="fast-eigenvector-centrality">Fast Eigenvector Centrality</h2>

<p>The plan for testing would be to first make sure that the code results are close to the original approach and possibly also compare to an SVD approach.</p>

<h2 id="brain-size-ala-maarten">Brain Size ala Maarten</h2>

<p>We ended up dropping the ball in getting Maarten some of these scripts.</p>

<p>I need to create an input file with <code>T1file,age,sex</code>. If I am using the NKI Rockland pilot dataset, then I believe I should be able to find the relevant path. For the most recent data, there have been additions so let me confirm that I have access to everything. Ok so first, pilot dataset.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">rawdir    <span class="o">&lt;-</span> <span class="s">&#39;/home2/data/Originals/Rockland/raw&#39;</span>
</span><span class="line">phenofile <span class="o">&lt;-</span> <span class="s">&#39;/home2/data/Originals/Rockland/NKI.1-39_phenotypic.csv&#39;</span>
</span><span class="line">
</span><span class="line">pheno     <span class="o">&lt;-</span> read.csv<span class="p">(</span>phenofile<span class="p">)</span>
</span><span class="line">df        <span class="o">&lt;-</span> pheno<span class="p">[,</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">12</span><span class="p">)]</span>
</span><span class="line">df<span class="o">$</span>paths  <span class="o">&lt;-</span> file.path<span class="p">(</span>rawdir<span class="p">,</span> df<span class="o">$</span>Subject<span class="p">,</span> <span class="s">&quot;touse&quot;</span><span class="p">,</span> <span class="s">&quot;anat&quot;</span><span class="p">,</span> <span class="s">&quot;mprage.nii.gz&quot;</span><span class="p">)</span>
</span><span class="line">df<span class="o">$</span>exists <span class="o">&lt;-</span> file.exists<span class="p">(</span>df<span class="o">$</span>paths<span class="p">)</span><span class="o">*</span><span class="m">1</span>
</span><span class="line">
</span><span class="line">df.txt <span class="o">&lt;-</span> df<span class="p">[</span>df<span class="o">$</span>exists<span class="o">==</span><span class="m">1</span><span class="p">,</span>c<span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span>
</span><span class="line">write.table<span class="p">(</span>df.txt<span class="p">,</span> file<span class="o">=</span><span class="s">&quot;rockland_pilot.txt&quot;</span><span class="p">,</span> row.names<span class="o">=</span><span class="k-Variable">F</span><span class="p">,</span> col.names<span class="o">=</span><span class="k-Variable">F</span><span class="p">,</span> quote<span class="o">=</span><span class="k-Variable">F</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I want to now look at the Enhanced dataset.</p>

<h2 id="thoughts">Thoughts</h2>

<h3 id="plan-better">Plan Better</h3>

<p>Last few days I feel that I haven’t gotten through as much as I could have. Possibly due to not sleeping as much and partly due to more socializing like with the speaker’s visit and a new office mate. Let’s try differently today.</p>

<h3 id="link-to-pages-by-week-and-month">Link to pages by week and month</h3>

<p>Another nice thing would be to have a summary page at the end of the week with links to all the other pages that week (might want to check if those exist?) and similarly at the end of the month could have a page with the lists for that month. I wonder if this could be within the pages section?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/05/week-49-thursday/">Week 49 - Thursday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-05T11:48:00-05:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
  <li>ABIDE
    <ul>
      <li>[x] QC (1 hour)</li>
    </ul>
  </li>
  <li>Fast Eigenvector Centrality
    <ul>
      <li>[x] Tried installing the C++ version (2 hrs)</li>
    </ul>
  </li>
  <li>Tagging</li>
</ul>

<h2 id="abide">ABIDE</h2>

<p>I am still waiting on Xinian to get back to me about his global signal regressed data (getting filtered vs non-filtered data).</p>

<p>I want to also get some QC done today.</p>

<h2 id="cpac">CPAC</h2>

<h3 id="fecm">fECM</h3>

<p>I was tried to install the fast eigenvector centrality code but had problems with importing all the C++11 headers on my mac. It wasn’t totally clear what was wrong to me except that the mac doesn’t really ship with the latest gear. So I contacted Stan to install a very recent version of gcc on rocky and I tried to install the latest version of gcc on my computer through home-brew. Still waiting on the first option and for the second, after some work, I was able to start the following command <code>brew install --enable-cxx --enable-fortran gcc49</code>. This failure is a little disappointing because it seems so simple but I’ve now hung up my towel for the moment and going to focus on my other tasks.</p>

<h2 id="tagging">Tagging</h2>

<p>I really want to get at least one hour of tagging into the mix here.</p>

<h2 id="general">General</h2>

<p>I emailed Dan Dickstein suggesting to use the R version of CWAS for now and pointed him to an install script that I have on github.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/04/week-49-wednesday/">Week 49 - Wednesday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-04T10:02:00-05:00" pubdate data-updated="true">Dec 4<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="summarytodo">Summary/TODO</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[x] QC (1 hour)</li>
    </ul>
  </li>
  <li>CPAC (related to ABIDE)
    <ul>
      <li>[] Functional Density Mapping</li>
      <li>[] Fast Eigenvector Centrality
        <ul>
          <li>[x] Respond to Wink</li>
          <li>[x] Tried installing the C++ version (1 hr)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>[] Tagging</li>
  <li>Dan Dickstein CWAS
    <ul>
      <li>[x] Get details from Dan</li>
      <li>[x] Phil Meeting about CWAS Paper. Discussed way to get confidence intervals for simulation power analysis. (1 hr)</li>
    </ul>
  </li>
  <li>CWAS with Steve. Worked out a plan to have a workable version of CWAS into the next release (30 min)</li>
  <li>Went to talk with Matt Hutchinson. Asked a super intelligent question. (1-2 hrs)</li>
</ul>

<h2 id="abide-qc">ABIDE QC</h2>

<p>Start at 10am till 11am.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/12/03/week-49-tuesday/">Week 49 - Tuesday</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-12-03T11:30:00-05:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>testing draft</p>

<h2 id="summarytodo">Summary/TODO</h2>

<ul>
  <li>ABIDE
    <ul>
      <li>[x] Create quick pack for degree centrality</li>
      <li>[x] Email Xinian about GSR data and having filtered/non-filtered</li>
      <li>[x] Finish creating quick pack for LFCD</li>
    </ul>
  </li>
  <li>CPAC
    <ul>
      <li>[] Run an initial test of the functional node</li>
    </ul>
  </li>
  <li>Tag</li>
</ul>

<p>I also took the speaker (Matt) out to lunch with Zhen, and then showed him some of my slides about CWAS.</p>

<h2 id="quick-pack-for-centrality">Quick Pack for Centrality</h2>

<h3 id="cpac-preprocessed-data">CPAC Preprocessed Data</h3>

<p>The scripts for this analysis are located in <code>/data/Projects/ABIDE_Initiative/CPAC/abide/config/30_centrality</code>. I was able to first generate a subject list YAML file with <code>10_gen_quick_pack.py</code>. Below is a sample of what a file for one subject looks like:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class=""><span class="line">  functional_brain_mask: {filt_global: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
</span><span class="line">    filt_noglobal: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
</span><span class="line">    nofilt_global: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz,
</span><span class="line">    nofilt_noglobal: /home2/data/Projects/ABIDE_Initiative/CPAC/Output_2013-11-22/pipeline_MerrittIsland/0050642_session_1/functional_brain_mask/_scan_rest_1_rest/rest_3dc_tshift_RPI_3dv_automask.nii.gz}</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>We can see that we have each filtering and global option as the input. This is a little bit of cheating since the different input keys are interpreted as different scans.</p>

<p>We can then use these different inputs in one CPAC run with <code>20_run_gen_quick_pack.py</code>. This script is currently running and the output/working directories can be found in <code>/data/Projects/ABIDE_Initiative/Derivatives/CPAC/Cent</code>.</p>

<h2 id="eigenvector-centrality">Eigenvector Centrality</h2>

<p>I emailed out to the author of the fast implementation paper to ask for his C++ code. However, if the author does not respond, the paper is fairly descriptive and I imagine it would be possible to write our own code based on the methods description.</p>

<h2 id="qc">QC</h2>

<p>I created the new excel file and looked through one subject. Should confirm the following: should have columns for anat, func, and reg with comments for each of those, and a final status column and final comments column. Do I need anything for the segmentations?</p>

<h2 id="functional-density-mapping">Functional Density Mapping</h2>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  

<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/abide' style='font-size: 135.0%'>abide(7)</a> <a href='/blog/categories/cmi' style='font-size: 160.0%'>cmi(12)</a> <a href='/blog/categories/cpac' style='font-size: 145.0%'>cpac(9)</a> <a href='/blog/categories/cwas' style='font-size: 150.0%'>cwas(10)</a> <a href='/blog/categories/emotional-bs' style='font-size: 110.0%'>emotional-bs(2)</a> <a href='/blog/categories/jekyll' style='font-size: 105.0%'>jekyll(1)</a> <a href='/blog/categories/mdmr' style='font-size: 105.0%'>mdmr(1)</a> <a href='/blog/categories/nilearn' style='font-size: 115.0%'>nilearn(3)</a> <a href='/blog/categories/quickpack' style='font-size: 130.0%'>quickpack(6)</a> <a href='/blog/categories/r' style='font-size: 105.0%'>r(1)</a> <a href='/blog/categories/simulations' style='font-size: 105.0%'>simulations(1)</a> <a href='/blog/categories/work' style='font-size: 105.0%'>work(1)</a> <a href='/blog/categories/writedown' style='font-size: 105.0%'>writedown(1)</a> </span>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/18/dparsf-quick-pack/">DPARSF Quick Pack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/17/cpac-derivative-inputs/">CPAC Derivative Inputs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/13/week-50-friday/">Week 50 - Friday</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/10/installing-connectir/">Installing Connectir</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/09/week-50-monday/">Week 50 - Monday</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/czarrar">@czarrar</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'czarrar',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:czarrar">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "czarrar"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>

<!--
    Calendar aside/plugin for octopress blogging framework.
    Copyright (C) 2012  Neeraj Kumar ( neerajpkumar@gmail.com, neerajkumar@outlook.com)

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
&#8211;>
<style>
	.highlighted-calendar-day
	{
		color : #CCC;
		font-weight : bold;
	}
	
	.calendar-header-day{
		font-weight : bold;
		color : #AAA;
		font-size : 14px;
	}
	
	.highlighted-calendar-day a
	{
		
	}
	
	.prev-link
	{
		float:left;
	}
	
	.next-link
	{
		float: right;
	}
	.calendar-day
	{
		color : #888;
		font-weight : 12px;
	}
	
	.calendar-table
	{
		width : 100%;
		
	}
	
	.calendar-table td
	{
		border-right : dotted 1px lightgrey;
		text-align : center;
	}
	
	.calendar-table td:last-child
	{
		border-right : none;
	}
	
	.calendar-table th
	{
		background-color : lightgrey;
		text-align : center;
	}
	.prevCalendarLink img
	{	
		
		width : 20px;
		height : 20px;
		border: 0px;
		float: left;
		
	}
	
	.nextCalendarLink img
	{
		
		width : 20px;
		height: 20px;
		border: 0px;
		float: right;
		
	}
</style>
<script type="text/javascript" src="/javascripts/calendar.js"></script>
<section id="calendarDiv">
	<h1>Calendar</h1>
	<span style="display:block" id="calendarSpan"></span>
	<div>
		<a href="#" class="previousMonth show"/><a href="#" class="nextMonth hide"/>
	</div>
</section>
<script type="text/javascript">
  
monthCalendar = function(id,year,month)
{
  var highlightArray = new Array();
  var hightlightLinks = new Array();
  
  highlightArray.push('12/18/2013');
  hightlightLinks.push('/blog/2013/12/18/dparsf-quick-pack/');
  
  highlightArray.push('12/17/2013');
  hightlightLinks.push('/blog/2013/12/17/cpac-derivative-inputs/');
  
  highlightArray.push('12/13/2013');
  hightlightLinks.push('/blog/2013/12/13/week-50-friday/');
  
  highlightArray.push('12/10/2013');
  hightlightLinks.push('/blog/2013/12/10/installing-connectir/');
  
  highlightArray.push('12/09/2013');
  hightlightLinks.push('/blog/2013/12/09/week-50-monday/');
  		
  var cal = new Calendar(month,year,highlightArray,hightlightLinks);
  cal.generateHTML(id);
  var element = document.getElementById(id);
  element.innerHTML = cal.getHTML();
}
	
loadCalendar = function(){
  var now = new Date();
  var month = now.getMonth();
  var year = now.getFullYear();
  monthCalendar('calendarDiv',year,month);
}
	
	if(Array.prototype.indexOf == undefined)
	{
		 Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
			"use strict";
			if (this == null) {
				throw new TypeError();
			}
			var t = Object(this);
			var len = t.length >>> 0;
			if (len === 0) {
				return -1;
			}
			var n = 0;
			if (arguments.length > 0) {
				n = Number(arguments[1]);
				if (n != n) { // shortcut for verifying if it's NaN
					n = 0;
				} else if (n != 0 && n != Infinity && n != -Infinity) {
					n = (n > 0 || -1) * Math.floor(Math.abs(n));
				}
			}
			if (n >= len) {
				return -1;
			}
			var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
			for (; k < len; k++) {
				if (k in t && t[k] === searchElement) {
					return k;
				}
			}
			return -1;
		}
	}
$(document).ready(function(){
  loadCalendar();
});
</script>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Zarrar Shehzad -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
